<button class="sender">Send me</button>
    <script src="https://apis.google.com/js/client.js?onload=checkAuth">
    </script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script type="text/javascript">
	$(document).ready(function() {
		var token = 'EwCIAul3BAAUo4xeBIbHjhBxWOFekj4Xy2fhaGQAAb05BOu3eA2BavX+qflv/v8jA9O0Jf8/0i2yXTA+XjcpilQx0FWjast/YBUXDwDeHwciFUD0WPPHF2oy4gSVCPI01hreFWxmlFis0h6zouV2oO2tg3pSajKxf79qwCP0D0uOhv/GZaaj6oKX9iIzQ6h7wZohN/v/hlee5V826wOA7tvawS2nB8jicw7RCtZADq/jrIyQN783RTO5DkE2JDe+uQWGwLqkcdApeFiCnfv2hFN86AITMx23mlOihTnqlUxmHNcZNktiea1jYzDJ59AThPInLegYzvyR2L/NIbbvSLpjNc6L9BCVbLaszsB+MnN473/XXcoggZviUQOUTjYDZgAACFnEg+f6I+pbWAEnSD1aX21QJC6avT/Zb6U5+CkKgrDVDydO1hUm6a4ViJjJUtJ9Jk62xN+AWnQizeDBUkVuCcGMpSr6CcjXUQyy4gKApUAJc3dzYRfqxB+gC2MYQSq47pUWMEGWfcy5KXxAhp73hJZegzm2peuYCcPy5fKdkUzdG9dEePNBh6WiS4uIw2LOnlFMprlVnMk0dJ1j59xUW04ZYoQWvLKUr18/pUdcD3+k671aINtzK2quze4bESYkLeZ5+gZx6MrMXrG9GFK/SQD1UATfP3yOeC/EhuvCweeLWl7SD7Jwn21EcWG4K0f/Bh9kNHaNzDfBGLW88LpziH9NbuQKP5pDuNLki9eym3gYboOALlXIrNs8WvaWrp1xynKYrb1Qe7Fy60ayEQK9DrHeReMGYOsEVdy9Xo8AxQRPl4+Hv1cxDjAT61TbTl1/hgkJmhl+fL9dWElaNL62Vq3lIY8B';
		//var token = "ya29.Ci8MA4iQ5_lPM9k6MbhLP93yIJR7y5nPiG26lTrh9sHSyyC-CJTsNvtv7XzXsmIVWA";//window.location.hash.split("&")[0].substring(14);
	/*	
		var event = {
			"id": "1242151243",
			"start": {
				'dateTime': new Date(),
				'timeZone': 'America/Los_Angeles',
			},
			"end": {
				'dateTime': new Date(),
				'timeZone': 'America/Los_Angeles',
			},
			"description": "Test event",
			"location": "Seattle, WA",
			"source": {
				"url": "http://google.com",
				"title": "Title!"
			},
		};*/
		var event = {
		 "id": '1231',
		 "end": {
		  "dateTime": "2017-11-02T11:00:00-05:00",
		  "timeZone": "America/Toronto"
		 },
		 "start": {
		  "dateTime": "2017-11-02T10:00:00-05:00",
		  "timeZone": "America/Toronto"
		 },
		 "description": "test",
		 "summary": "test"
		}
		console.log(event);
		

		var payload = {
			"calendarId": "primary",
			"resource": event,	
		}

		var payload = {
		  "Subject": "Discuss the Calendar REST API",
		  "Body": {
		    "ContentType": "HTML",
		    "Content": "I think it will meet our requirements!"
		  },
		  "Start": {
		      "DateTime": "2016-06-26T18:00:00",
		      "TimeZone": "Pacific Standard Time"
		  },
		  "End": {
		      "DateTime": "2016-06-26T19:00:00",
		      "TimeZone": "Pacific Standard Time"
		  },
		  "Attendees": [
		    {
		      "EmailAddress": {
		        "Address": "janets@a830edad9050849NDA1.onmicrosoft.com",
		        "Name": "Janet Schorr"
		      },
		      "Type": "Required"
		    }
		  ]
		}
	    var json = JSON.stringify(payload)
		console.log(json);
		$('.sender').click(function() {

			$.ajax({
				type: "POST",
				url: 'https://outlook.office.com/api/v2.0/me/events',
				headers: {'Authorization': 'Bearer ' + token,
						  'Content-Type': 'application/json',
						 },
				data: json,
				'error': function(jqXHR, textStatus, errorThrown) {
						console.log(jqXHR)
					},
				'success': function(res) {
					console.log(res);
					alert("success");
				}	
			});
		});
	});
</script>